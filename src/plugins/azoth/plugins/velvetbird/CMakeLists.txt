CMAKE_MINIMUM_REQUIRED (VERSION 2.8)
PROJECT (leechcraft_azoth_velvetbird)
INCLUDE (InitLCPlugin OPTIONAL)

INCLUDE (${QT_USE_FILE})

SET (CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake)
FIND_PACKAGE (GLIB2 REQUIRED)
FIND_PACKAGE (LibPurple REQUIRED)

INCLUDE_DIRECTORIES (${AZOTH_INCLUDE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
	${LEECHCRAFT_INCLUDE_DIR}
	${LEECHCRAFT_INCLUDE_DIR}/azoth
	${GLIB2_INCLUDE_DIR}
	${LIBPURPLE_INCLUDE_DIRS}
	)

MESSAGE (STATUS "Bindir: ${CMAKE_CURRENT_BINARY_DIR}")

ADD_DEFINITIONS (${LIBPURPLE_DEFINITIONS})

SET (VELVETBIRD_SRCS
	velvetbird.cpp
	protomanager.cpp
	protocol.cpp
	account.cpp
	accregfirstpage.cpp
	util.cpp
	buddy.cpp
	convimmessage.cpp
	accountconfigdialog.cpp
	)
SET (VELVETBIRD_FORMS
	accregfirstpage.ui
	accountconfigdialog.ui
	)
SET (VELVETBIRD_RESOURCES azothvelvetbirdresources.qrc)
#CreateTrs ("azoth_velvetbird" "en;ru_RU;uk_UA" VELVETBIRD_COMPILED_TRANSLATIONS)

QT4_WRAP_UI (VELVETBIRD_UIS_H ${VELVETBIRD_FORMS})
QT4_ADD_RESOURCES (VELVETBIRD_RCCS ${VELVETBIRD_RESOURCES})

ADD_LIBRARY (leechcraft_azoth_velvetbird SHARED
	${VELVETBIRD_COMPILED_TRANSLATIONS}
	${VELVETBIRD_SRCS}
	${VELVETBIRD_UIS_H}
	${VELVETBIRD_RCCS}
	)
TARGET_LINK_LIBRARIES (leechcraft_azoth_velvetbird
	${QT_LIBRARIES}
	${LEECHCRAFT_LIBRARIES}
	${GLIB2_LIBRARIES}
	${LIBPURPLE_LIBRARIES}
	)

INSTALL (TARGETS leechcraft_azoth_velvetbird DESTINATION ${LC_PLUGINS_DEST})
#INSTALL (FILES ${VELVETBIRD_COMPILED_TRANSLATIONS} DESTINATION ${LC_TRANSLATIONS_DEST})
#INSTALL (FILES azothvelvetbirdsettings.xml DESTINATION ${LC_SETTINGS_DEST})
