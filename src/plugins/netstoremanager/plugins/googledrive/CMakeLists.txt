CMAKE_MINIMUM_REQUIRED (VERSION 2.8)
PROJECT (leechcraft_netstoremanager_googledrive)
INCLUDE (InitLCPlugin OPTIONAL)

SET (CMAKE_MODULE_PATH "${CMAKE_CURRENT_SOURCE_DIR}/cmake")

FIND_PACKAGE (QJSON REQUIRED)
IF (NOT MSVC)
	FIND_PACKAGE (MAGIC REQUIRED)
	IF (MAGIC_FOUND)
		ADD_DEFINITIONS (-DHAVE_MAGIC)
	ENDIF (MAGIC_FOUND)
ENDIF (NOT MSVC)

INCLUDE_DIRECTORIES (${NETSTOREMANAGER_INCLUDE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
	${CMAKE_CURRENT_SOURCE_DIR}
	${LEECHCRAFT_INCLUDE_DIR}
	${QJSON_INCLUDE_DIR}
	${MAGIC_INCLUDE_DIR}
	)

SET (GOOGLEDRIVE_SRCS
	account.cpp
	authmanager.cpp
	core.cpp
	drivemanager.cpp
	googledrive.cpp
	uploadmanager.cpp
	xmlsettingsmanager.cpp
	)
SET (GOOGLEDRIVE_HEADERS
	account.h
	authmanager.h
	core.h
	drivemanager.h
	googledrive.h
	uploadmanager.h
	xmlsettingsmanager.h
	)

SET (GOOGLEDRIVE_RESOURCES netstoremanagergoogledriveresources.qrc)

CreateTrs ("netstoremanager_googledrive" "en;ru_RU" GOOGLEDRIVE_COMPILED_TRANSLATIONS)

IF (NOT LC_NO_MOC)
	QT4_WRAP_CPP (GOOGLEDRIVE_MOC_SRCS ${GOOGLEDRIVE_HEADERS})
ENDIF (NOT LC_NO_MOC)
QT4_ADD_RESOURCES (GOOGLEDRIVE_RCCS ${GOOGLEDRIVE_RESOURCES})

ADD_LIBRARY (leechcraft_netstoremanager_googledrive SHARED
	${GOOGLEDRIVE_COMPILED_TRANSLATIONS}
	${GOOGLEDRIVE_SRCS}
	${GOOGLEDRIVE_MOC_SRCS}
	${GOOGLEDRIVE_UIS_H}
	${GOOGLEDRIVE_RCCS}
	)
TARGET_LINK_LIBRARIES (leechcraft_netstoremanager_googledrive
	${QT_LIBRARIES}
	${LEECHCRAFT_LIBRARIES}
	${QJSON_LIBRARIES}
	${MAGIC_LIBRARIES}
	)

INSTALL (TARGETS leechcraft_netstoremanager_googledrive DESTINATION ${LC_PLUGINS_DEST})
INSTALL (FILES nsmgoogledrivesettings.xml DESTINATION ${LC_SETTINGS_DEST})
INSTALL (FILES ${GOOGLEDRIVE_COMPILED_TRANSLATIONS} DESTINATION ${LC_TRANSLATIONS_DEST})
